<%# The main show page for small screens %>
<div class="small-screen">
  <%# Image slider%>
  <%= image_tag "dummy_image.png", class: "card-img-top"%>
  <hr class="border border-primary border-2 opacity-75"/>
 
  <div class="container">
    <div class="row">
      <%# name%>
      <h1 class="col-sm-7"><%= @item.name %></h1>
      <%# available badge%>
      <div class="col-sm-2 ms-auto">
        <%= render(ItemAvailabilityBadgeComponent.new(item: @item, user: current_user)) %>
      </div>
    </div>
    <div class="row">
      <%# owner%>
      <% group_names = Group.find_by_sql ["SELECT GROUP_CONCAT(g.name) AS group_names
                                 FROM groups g
                                 INNER JOIN permissions p ON p.group_id = g.id
                                 WHERE p.item_id = :item_id AND p.permission_type = :permission_type
                                 GROUP BY g.id",
                                { item_id: @item.id, permission_type: "1" }] %>
      <p class="card-text">
        <%= I18n.t("items.card_text.owner") %>
        <span class="text-warning"><%=group_names.first.group_names%></span>
      </p>
    </div>
  </div>


  <hr class="border border-primary border-2 opacity-75"/>
  <%# Description%>
  <p class="card-text"><%= @item.description %></p>
  <div id="item-location-small" style="height: 240px;"></div>
  <%# Attributes %>
  <table class="table">
    <tbody>
    <tr>
      <td>Spieler: 5</td>
    </tr>
    <tr>
      <td>Alter: 12+</td>
    </tr>
    <tr>
      <td>Typ: Brettspiel+</td>
    </tr>
    <tr>
      <td>Jahr: 2014+</td>
    </tr>
    </tbody>
  </table>
  <%# Main Button %>
  <%= link_to I18n.t("items.buttons.edit"), edit_item_path(@item) %> |
  <%= link_to I18n.t("items.buttons.back"), items_path %> |
  <%= link_to I18n.t("items.buttons.download_qrcode"), download_path(@item) %>
  <%# <%= button_to "Destroy this item", @item, method: :delete %>
  <div class="button-blocker">
  </div>
   <% if current_user.lending_rights?(@item) and @src_is_qrcode %>
  <%= form_tag item_update_lending_path(@item), method: :patch do %>
    <%= hidden_field_tag 'lat'  %>
    <%= hidden_field_tag 'lng'  %>
    <%= button_tag @item.button_text(current_user), class: "btn btn-primary item-action-button" %>
  <% end %>
  <script>
    getLocation();
  </script>
<% end %>
</div>
